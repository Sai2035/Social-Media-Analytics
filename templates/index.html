<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Influencer Analyzer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <style>
        /* Keep page-specific layout but lean on shared styles */
        body { min-height: 100vh; display: flex; flex-direction: column; margin: 0; }
        .container { text-align: center; padding: 84px 20px 20px; flex-grow: 1; display: flex; justify-content: center; align-items: center; min-height: calc(100vh - 64px); }
        .block { background:var(--card); color:var(--fg); padding: 24px; border-radius: 16px; margin: 10px; border:1px solid var(--border); width: 420px; height: 300px; display:flex; flex-direction:column; justify-content:center; align-items:center; transition: transform .2s ease, box-shadow .2s ease; }
        .block:hover { transform: translateY(-2px); box-shadow: 0 12px 24px rgba(0,0,0,.08); }
        .block h2 { font-weight:800; font-size:2rem; margin-bottom: 12px; }
        .block p { font-size:1.05rem; color:var(--muted); margin-bottom: 18px; }
        .arrow { font-size:1.5rem; }
        @media (max-width: 768px) {
            .container { padding-top: 72px; }
            .block { width: 100%; height: 250px; margin: 6px; padding: 20px; }
            .block h2 { font-size: 1.8rem; }
            .block p { font-size: .95rem; }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand navbar-ig sticky-top px-3 py-2">
        <div class="brand-badge">
            <span class="logo-sq round" style="background:none;box-shadow:none"><img src="{{ url_for('static', filename='logo1.jpg') }}" alt="logo" style="width:22px;height:22px;border-radius:8px"></span>
            <span class="app-name">Influencer Analyzer</span>
        </div>
        <div class="ms-auto d-flex align-items-center gap-3">
            <span class="theme-toggle" id="themeToggle"><span class="dot"></span><span>Theme</span></span>
            <a class="link-ig" href="{{ url_for('home') }}">Home</a>
            <a class="link-ig" href="{{ url_for('creator') }}">Creator</a>
            <a class="link-ig" href="{{ url_for('brand') }}">Brand</a>
            {% if session.get('email') %}
                <a class="link-ig" href="{{ url_for('logout') }}">Logout</a>
            {% else %}
                <button class="btn btn-ghost" data-bs-toggle="modal" data-bs-target="#loginModal">Log in</button>
                <button class="btn btn-ig" data-bs-toggle="modal" data-bs-target="#signupModal">Sign up</button>
            {% endif %}
        </div>
    </nav>
    <div class="grad-bar"></div>

    <div class="container">
        <div class="w-100">
            <h1 class="hero-title mb-4">Find and Track Instagram Influencers</h1>
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <div class="block card-ig">
                        <h2>I'm a Creator</h2>
                        <p>Explore reports or craft your own</p>
                        <a class="link-ig" href="{{ url_for('creator') }}">Get Started <span class="arrow">→</span></a>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="block card-ig">
                        <h2>I'm a Brand</h2>
                        <p>Discover influencers for collab</p>
                        <a class="link-ig" href="{{ url_for('brand') }}">Get Started <span class="arrow">→</span></a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal fade modal-ig" id="loginModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content p-2">
                <div class="modal-header">
                    <h5 class="modal-title">Log in</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="loginError" class="alert alert-danger d-none"></div>
                    <form id="loginForm">
                        <div class="mb-3 text-start">
                            <label for="loginEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="loginEmail" required>
                        </div>
                        <div class="mb-3 text-start">
                            <label for="loginPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="loginPassword" required>
                        </div>
                        <button type="submit" class="btn btn-ig w-100">Log in</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal fade modal-ig" id="signupModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content p-2">
                <div class="modal-header">
                    <h5 class="modal-title">Sign up</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="signupError" class="alert alert-danger d-none"></div>
                    <form id="signupForm">
                        <div class="mb-3 text-start">
                            <label for="signupEmail" class="form-label">Company Email</label>
                            <input type="email" class="form-control" id="signupEmail" required>
                        </div>
                        <div class="mb-3 text-start">
                            <label for="signupPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="signupPassword" required>
                        </div>
                        <button type="submit" class="btn btn-ig w-100">Create account</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Theme toggle
        const rootEl = document.documentElement;
        document.getElementById('themeToggle').addEventListener('click', () => {
            const isDark = rootEl.getAttribute('data-theme') === 'dark';
            if (isDark) { rootEl.removeAttribute('data-theme'); localStorage.removeItem('theme'); }
            else { rootEl.setAttribute('data-theme','dark'); localStorage.setItem('theme','dark'); }
        });
        if (localStorage.getItem('theme') === 'dark') rootEl.setAttribute('data-theme','dark');
    </script>
    <script>
    const loginForm = document.getElementById('loginForm');
    const signupForm = document.getElementById('signupForm');

    if (loginForm) {
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const errorDiv = document.getElementById('loginError');
            errorDiv.classList.add('d-none');
            try {
                const res = await fetch('/login', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ email, password }) });
                const data = await res.json();
                if (data.success) { window.location.reload(); } else { errorDiv.textContent = data.error || 'Login failed'; errorDiv.classList.remove('d-none'); }
            } catch(err){ errorDiv.textContent = 'Network error. Try again.'; errorDiv.classList.remove('d-none'); }
        });
    }

    if (signupForm) {
        signupForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const errorDiv = document.getElementById('signupError');
            errorDiv.classList.add('d-none');
            try {
                const res = await fetch('/signup', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ email, password }) });
                const data = await res.json();
                if (data.success) { window.location.reload(); } else { errorDiv.textContent = data.error || 'Signup failed'; errorDiv.classList.remove('d-none'); }
            } catch(err){ errorDiv.textContent = 'Network error. Try again.'; errorDiv.classList.remove('d-none'); }
        });
    }
    </script>
</body>
</html>